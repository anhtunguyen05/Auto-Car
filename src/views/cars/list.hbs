<div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
    <h1 class="h2">Car Management</h1>
    <div class="btn-toolbar mb-2 mb-md-0">
        <a href="/cars/add" class="btn btn-primary">
            <i class="bi bi-plus-circle"></i> Add New Car
        </a>
    </div>
</div>

<div class="row mb-3">
    <div class="col-md-8">
        <form class="d-flex" method="GET" action="/cars">
            <input class="form-control me-2" type="search" name="search" placeholder="Search cars..." value="{{search}}">
            <button class="btn btn-outline-primary" type="submit">
                <i class="bi bi-search"></i> Search
            </button>
        </form>
    </div>
    <div class="col-md-4">
        <select class="form-select" id="filterStatus" onchange="filterByStatus(this.value)">
            <option value="" {{#unless status}}selected{{/unless}}>All Status</option>
            <option value="AVAILABLE" {{#if (eq status 'AVAILABLE')}}selected{{/if}}>Available</option>
            <option value="RENTED" {{#if (eq status 'RENTED')}}selected{{/if}}>Rented</option>
            <option value="MAINTENANCE" {{#if (eq status 'MAINTENANCE')}}selected{{/if}}>Maintenance</option>
        </select>
    </div>
</div>

<div class="table-responsive">
    <table class="table table-striped table-hover">
        <thead>
            <tr>
                <th>Brand & Model</th>
                <th>License Plate</th>
                <th>Price/Day</th>
                <th>Status</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {{#each cars}}
            <tr>
                <td>
                    <strong>{{this.brand}} {{this.model}}</strong>
                </td>
                <td>{{this.licensePlate}}</td>
                <td>${{this.pricePerDay}}</td>
                <td>
                    <span class="badge bg-{{statusColor this.status}}">{{this.status}}</span>
                </td>
                <td>
                    <div class="btn-group btn-group-sm">
                        <a href="/cars/{{this._id}}" class="btn btn-outline-info" title="View">
                            <i class="bi bi-eye"></i>
                        </a>
                        <a href="/cars/edit/{{this._id}}" class="btn btn-outline-primary" title="Edit">
                            <i class="bi bi-pencil"></i>
                        </a>
                        <button onclick="deleteCar('{{this._id}}')" class="btn btn-outline-danger" title="Delete">
                            <i class="bi bi-trash"></i>
                        </button>
                    </div>
                </td>
            </tr>
            {{else}}
            <tr>
                <td colspan="5" class="text-center py-4">
                    <i class="bi bi-inbox fs-1 text-muted"></i>
                    <p class="text-muted">No cars found</p>
                </td>
            </tr>
            {{/each}}
        </tbody>
    </table>
</div>

{{#if pagination}}
<nav>
    <ul class="pagination justify-content-center">
        <li class="page-item {{#unless pagination.hasPrev}}disabled{{/unless}}">
            <a class="page-link" href="?page={{pagination.prevPage}}">Previous</a>
        </li>
        {{#each pagination.pages}}
        <li class="page-item {{#if this.active}}active{{/if}}">
            <a class="page-link" href="?page={{this.number}}">{{this.number}}</a>
        </li>
        {{/each}}
        <li class="page-item {{#unless pagination.hasNext}}disabled{{/unless}}">
            <a class="page-link" href="?page={{pagination.nextPage}}">Next</a>
        </li>
    </ul>
</nav>
{{/if}}
